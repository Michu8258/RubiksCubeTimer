function GetDate(n,t,i){let u=n.getDate();u<10&&(u="0"+u);let f=n.getMonth()+1;f<10&&(f="0"+f);let c=n.getFullYear(),e=n.getHours();e<10&&(e="0"+e);let o=n.getMinutes();o<10&&(o="0"+o);let s=n.getSeconds();s<10&&(s="0"+s);let r=n.getMilliseconds();r<10?r="00"+r:r<100&&(r="0"+r);let h="";return(h=i==!0?f+"-"+u+"-"+c+" "+e+":"+o+":"+s:u+"-"+f+"-"+c+" "+e+":"+o+":"+s,t===!0)?h+"."+r:h}function SolveDone(n){$("#MeasuredTime").text(GetTimefromMiliseconds(n));result=n;$("#MarkAsDNF").prop("checked",!1);$("#AddPenalty").prop("checked",!1);$("#MarkAsFinished").prop("checked",!1);$("#SolveDone").removeClass("d-none")}function HandleAddTimeResponse(n){$("#SeriesID").val(n.seriesID);$("#TableSerieId").text(n.seriesID);$("#UserID").val(n.userID);$("#TableSerieStartTime").text(n.seriesStartTime);n.seriesFinished==!0&&$("#SerieFinished").attr("checked",!0);n.atLeastOneDNF==!0&&$("#AtLeastOneDNF").attr("checked",!0);UpdateTimeStatistics(n);AddNewTimeToTable(n);AddNewTimeToChart(n)}function UpdateTimeStatistics(n){$("#BestTime").text(GetTimefromMiliseconds(n.bestTimeMS));$("#WorstTime").text(GetTimefromMiliseconds(n.worstTimeMS));$("#AverageTime").text(GetTimefromMiliseconds(n.averageTimeMS));$("#MeanOf3").text(GetTimefromMiliseconds(n.meanOf3MS));$("#AverageOf5").text(GetTimefromMiliseconds(n.averageOf5MS))}function AddNewTimeToTable(n){n.newTimeNumber==1&&$("#SolvesTableBody").empty();AddResultToTimesTable(n)}function AddResultToTimesTable(n){$("#SolvesData").append('<tr><td class="align-middle">'+n.newTimeNumber+'<\/td><td class="align-middle">'+GetTimefromMiliseconds(n.newTimeDurationMS)+'<\/td><td class="align-middle">'+n.newTimeSpan+"<\/td>"+GetCheckboxString(n.newTimeDNF)+GetCheckboxString(n.newTimePenalty)+"<\/tr>")}function GetCheckboxString(n){return n==!0?'<td class="align-middle"><input type="checkbox" disabled checked /><\/td>':'<td class="align-middle"><input type="checkbox" disabled /><\/td>'}function AddNewTimeToChart(n){chartData.labels.push(chartData.datasets[0].data.length+1);chartData.datasets[0].data.push(n.newTimeDurationMS/1e3);TakeCareOfTimeUnit()}let startTime,elapsedTime,miliseconds=0,interval,result=0;window.addEventListener("keydown",function(n){n.keyCode==32&&n.target==document.body&&n.preventDefault()});$(window).bind("beforeunload",function(){$.post("/Timer/MarkSeriesAsFinished",{serieId:$("#SeriesID").val()},function(){})});$(document).ready(function(){InitializeCartesianChart(document.getElementById("TimesChart").getContext("2d"),"bar",{enabled:!0,displayColors:!1,titleAlign:"center"});$("#TableSerieStartTime").text(GetDate(new Date,!1,!1))});$("body").keyup(function(n){n.keyCode==32&&miliseconds>=0&&!$("#SerieFinished").is(":checked")&&(LockInterface(),startTime=Date.now(),interval=setInterval(function(){$("#MeasuredTime").text(GetTimefromMiliseconds(miliseconds));miliseconds+=20},20))}).keydown(function(n){n.keyCode==32&&miliseconds>0&&!$("#SerieFinished").is(":checked")&&(clearInterval(interval),miliseconds=-10,SolveDone(Date.now()-startTime))});$("#DiscardSolveResult").click(function(){$("#SolveDone").addClass("d-none");$("#MeasuredTime").text(GetTimefromMiliseconds(0));miliseconds=0;UnlockInterface();Scramble()});$("#SendSolveResult").click(function(){$("#SolveDone").addClass("d-none");$("#MeasuredTime").text(GetTimefromMiliseconds(0));miliseconds=0;$.post("/Timer/AddSolve/",{userId:$("#UserID").val(),categoryId:$("#CategoryID").val(),cubeId:$("#CubeID").val(),optionId:$("#OptionID").val(),seriesDone:$("#MarkAsFinished").is(":checked"),miliseconds:result,dnf:$("#MarkAsDNF").is(":checked"),penalty:$("#AddPenalty").is(":checked"),seriesId:$("#SeriesID").val(),timeStamp:GetDate(new Date,!0,!1),scramble:GetCurrentScramble()},function(n){if(n.isFaulted){let t={};t.responseText=JSON.stringify(n);DisplayMessages(t)}else HandleAddTimeResponse(n.jsonData)});UnlockInterface();Scramble()});